import{e as j,i as g,r as d,j as e,f as l}from"./index-CeVDEEei.js";import{m as T,g as M,h as N,i as w}from"./Layout-CcMNNaZ4.js";import{P as v}from"./PageTitle-BNFwlyPJ.js";import{u as B}from"./useAsync-BXK40Pcd.js";import"./iconBase-DoKym2qq.js";const f={getAllSchools:async()=>j.get("/schools/get-all-schools"),getSchoolById:async s=>j.get(`schools/get-school/${s}`),addSchool:async s=>j.post("/schools/add-school",s),updateSchool:async(s,t)=>j.put(`/schools/update-school/${s}`,t),deleteSchool:async s=>j.delete(`/schools/delete-school/${s}`)},k=({isOpen:s,onClose:t,school:a,onSuccess:p})=>{const{t:o}=g(),[c,m]=d.useState({name:"",location:"",lunchTime:""}),[h,S]=d.useState(!1);d.useEffect(()=>{m(a?{name:a.name,location:a.location,lunchTime:a.lunchTime}:{name:"",location:"",lunchTime:""})},[a]);const i=x=>{const{name:r,value:y}=x.target;m(C=>({...C,[r]:y}))},u=async x=>{x.preventDefault(),S(!0);try{let r;a?r=await f.updateSchool(a._id,c):r=await f.addSchool(c),r.success&&(t(),p())}catch{}finally{S(!1)}};return e.jsxs(l.Modal,{isOpen:s,onClose:t,children:[e.jsx(l.ModalHeader,{children:o(a?"UpdateSchool":"AddSchool")}),e.jsxs("form",{onSubmit:u,children:[e.jsx(l.ModalBody,{children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs(l.Label,{children:[e.jsxs("span",{children:[o("SchoolName")," *"]}),e.jsx(l.Input,{className:"mt-1",name:"name",value:c.name,onChange:i,placeholder:"e.g. Sunshine Elementary",required:!0})]}),e.jsxs(l.Label,{children:[e.jsxs("span",{children:[o("Location")," *"]}),e.jsx(l.Input,{className:"mt-1",name:"location",value:c.location,onChange:i,placeholder:"e.g. 123 Main St, City",required:!0})]}),e.jsxs(l.Label,{children:[e.jsxs("span",{children:[o("LunchTime")," *"]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(l.Input,{type:"time",className:"w-32",name:"lunchTime",value:c.lunchTime,onChange:i,required:!0}),e.jsx(T,{className:"ml-2 text-gray-500"})]})]})]})}),e.jsxs(l.ModalFooter,{children:[e.jsx(l.Button,{layout:"outline",type:"button",onClick:t,disabled:h,children:o("Cancel")}),e.jsx(l.Button,{type:"submit",disabled:h,children:h?e.jsx("span",{children:"Processing..."}):o(a?"Update":"Save")})]})]})]})},I=()=>{const{t:s}=g(),{data:t,loading:a,reload:p}=B(f.getAllSchools),[o,c]=d.useState(!1),[m,h]=d.useState(null),[S,i]=d.useState(!1),[u,x]=d.useState(null),r=()=>{h(null),c(!0)},y=n=>{h(n),c(!0)},C=n=>{x(n),i(!0)},b=async()=>{try{await f.deleteSchool(u._id),p(),i(!1)}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(v,{children:s("Schools")}),e.jsxs(l.Modal,{isOpen:S,onClose:()=>i(!1),children:[e.jsx(l.ModalHeader,{children:s("Confirm Deletion")}),e.jsxs(l.ModalBody,{children:[s("Are you sure you want to delete")," ",e.jsx("strong",{children:u==null?void 0:u.name}),"?"," ",s("This action cannot be undone."),"."]}),e.jsxs(l.ModalFooter,{children:[e.jsx(l.Button,{layout:"outline",onClick:()=>i(!1),children:s("Cancel")}),e.jsx(l.Button,{layout:"danger",onClick:b,children:s("Delete")})]})]}),e.jsx(k,{isOpen:o,onClose:()=>{c(!1),p()},school:m}),e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden mb-5",children:e.jsx(l.CardBody,{children:e.jsx("div",{className:"flex justify-end",children:e.jsx(l.Button,{onClick:r,className:"rounded-md",iconLeft:M,children:s("AddSchool")})})})}),e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden",children:e.jsx(l.CardBody,{children:a?e.jsx("p",{children:s("Loading schools...")}):(t==null?void 0:t.length)===0?e.jsx("p",{children:s("No schools found. Add your first school.")}):e.jsx(l.TableContainer,{children:e.jsxs(l.Table,{children:[e.jsx(l.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(l.TableCell,{children:s("Name")}),e.jsx(l.TableCell,{children:s("Location")}),e.jsx(l.TableCell,{children:s("LunchTime")}),e.jsx(l.TableCell,{children:s("Actions")})]})}),e.jsx(l.TableBody,{children:t.map(n=>e.jsxs(l.TableRow,{children:[e.jsx(l.TableCell,{children:n.name}),e.jsx(l.TableCell,{children:n.location}),e.jsxs(l.TableCell,{children:[n.lunchTime," ",n.timeFormat]}),e.jsx(l.TableCell,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(l.Button,{layout:"link",size:"small",onClick:()=>y(n),children:e.jsx(N,{className:"w-5 h-5"})}),e.jsx(l.Button,{layout:"link",size:"small",onClick:()=>C(n),children:e.jsx(w,{className:"w-5 h-5 text-red-500"})})]})})]},n._id))})]})})})})]})};export{I as default};
